
<html>
	<head>
		<title>PUSH SCHEDULE</title>
		<script src="http://www.parsecdn.com/js/parse-1.2.8.min.js"></script>
		<script>
		Parse.initialize("eBS1K1uAUmYLZ82pRUeipced87whjFxu4b2Ju1Fn", "XJnob2TLSU4M7oQmXBOzX1qOagJKgVUJDRgzK1l3");
		
		//push a message
		function PushMessage(msg) {
			Parse.Cloud.run('pushMessageToAll', 
				{
					message: msg
				}, {
				success: function(result) {
					var x = document.getElementById("txt");
					x.value = result;
				},
				
				error: function(error) {
					var x = document.getElementById("txt");
					x.value = JSON.stringify(error);
				}
			});
		}
		
		
		//send push notification immediately
		function PushNow() {
			var elem = document.getElementById("message");
			var msg = elem.value;
			PushMessage(msg);			
		}
		
		
		var msgCounter = 0;
		var mySchedule;
		function SchedulePushMessage() {
			mySchedule = setInterval( function() { PushMessage("Hello " + msgCounter++); }, 2000);
		}		
		
		function StopSchedule() {
			clearInterval(mySchedule);
			alert("Stop schedule OK");
		}
		
		var counter = 0;
		function press(e){
			var unicode = e.keyCode ? e.keyCode : e.charCode;
			if(unicode == 13) {
				PushNow();
				var elem = document.getElementById("para");
				elem.innerHTML = "SENT: " + ++counter;		
			}
		}
		</script>
	</head>

	<body>
		RESULT: 
		</br>
		<textarea id="txt" rows="10" cols="160">
		</textarea>
		<p id="para">SENT: 0</p>
		
		MESSAGE:
		</br>
		<input id="message" type="text" onkeyup="press(event)">
		</br>	
		<button type="button" onclick="PushNow()">PushMessage</button>
		</br>
		<button type="button" onclick="SchedulePushMessage()">SchedulePushMessage</button>
		</br>
		<button type="button" onclick="StopSchedule()">StopSchedule</button>
		</br>
		
	</body>
</html>

