
<html>
	<head>
		<title>TEST SERVER FUNCTIONS</title>
		<script src="http://www.parsecdn.com/js/parse-1.2.8.min.js"></script>
		<script>
		//appID, JavaScriptID
		//Parse.initialize("eBS1K1uAUmYLZ82pRUeipced87whjFxu4b2Ju1Fn", "XJnob2TLSU4M7oQmXBOzX1qOagJKgVUJDRgzK1l3");
		Parse.initialize("h6NHFlPE69MuxSjTeGqfFLiy0ME5TUEJBtFZ2RZE", "A29qRkzcVepf2dLpl48CFQ9qeMMuAuv7wvJbOJSE");
		
		var counter = 1;
		function RunFunction() {
			var elem = document.getElementById("message");
			var funcName = elem.value;
			
			Parse.Cloud.run(funcName, {}, {
				success: function(result) {
					var x = document.getElementById("txt");
					x.value = result;
				},
			
				error: function(error) {
					var x = document.getElementById("txt");
					x.value = JSON.stringify(error);
				}
			});
			
			var elem = document.getElementById("para");
			elem.innerHTML = "Function [" + funcName + "], Sent [" + counter++ + "]";
		}
		
		function Get3Words() {	
			Parse.Cloud.run('get3Words', {}, {
				success: function(result) {
					var x = document.getElementById("txt");
					x.value = result;
				},
			
				error: function(error) {
					var x = document.getElementById("txt");
					x.value = JSON.stringify(error);
				}
			});
		}
		
		function Gen100Matches() {
			Parse.Cloud.run('gen100Matches', {}, {
				success: function(result) {
					var x = document.getElementById("txt");
					x.value = result;
				},
			
				error: function(error) {
					var x = document.getElementById("txt");
					x.value = JSON.stringify(error);
				}
			});
		}
		
		function LogIn() {	
			Parse.Cloud.run('logIn', {}, {
				success: function(result) {
					var x = document.getElementById("txt");
					x.value = result;
				},
			
				error: function(error) {
					var x = document.getElementById("txt");
					x.value = JSON.stringify(error);
				}
			});
		}
		
		function LogOut() {		
			Parse.Cloud.run(
				'logOut', 
				{
					"userId" : "KdLao1d",
					"sessionId" : "12345",
					"roomId" : "123",
				}, {
					success: function(result) {
						var x = document.getElementById("txt");
						x.value = result;
					},
				
					error: function(error) {
						var x = document.getElementById("txt");
						x.value = JSON.stringify(error);
					}
				}
			);
		}
		
		var start;
		var end;
		var nSum = 0;
		var sumTime = 0;
		var sumError = 0;
		var sche;
		
		function ScheduleGetMatch() {
			start = new Date();
			
			sche = setInterval( 
				function() {
					GetMatch();
					var elem = document.getElementById("txt2");
					var everage = sumTime / nSum;
					end = new Date();
					
					elem.value = 
						"ELAPSED TIME: " + (end - start)
						+ "\nSUM: " + nSum
						+ "\nTIME: " + sumTime
						+ "\nERROR: " + sumError
						+ "\nAVERAGE: " + everage;
				}, 				
				500);
		}
		
		function StopScheduleGetMatch() {
			clearInterval(sche);
			alert("Stop schedule OK");
		}
		
		
		function GetMatch() {
			Parse.Cloud.run(
				'refreshAllMatch', {
					roomType: 5
				}, {
					success: function(result) {
						var x = document.getElementById("txt");
						x.value = JSON.stringify(result);
					},
					error: function(error) {
						var x = document.getElementById("txt");
						x.value = JSON.stringify(error);
					}
				}
			);
		}
			
		function Submit() {
			Parse.Cloud.run('submit', 
				{
					"userId" : "KdLao1d",
					"sessionId" : "12345",
					"roomId" : "123",
					"time" : 3242,
					"word" : "banana"
				}, {
					success: function(result) {
						var x = document.getElementById("txt");
						x.value = result;
					},
				
					error: function(error) {
						var x = document.getElementById("txt");
						x.value = JSON.stringify(error);
					}
				}
			);
		}
		
		function GetResult() {
			var roomName = document.getElementById('roomName').value;
			Parse.Cloud.run('getResult', 
				{
					roomName: roomName,
				}, {
					success: function(result) {
						var x = document.getElementById("txt");
						x.value = result;
					},
				
					error: function(error) {
						var x = document.getElementById("txt");
						x.value = JSON.stringify(error);
					}
				}
			);
		}
		
		
		function GetRandomWords4_6() {
			var query = new Parse.Query('Words');
			query.select('english');
			query.containedIn('len', [4, 5, 6]);
			query.limit(1000);
			//query.skip(1000);
			query.find({
				success: function(result) {
					var x = document.getElementById("txt");
					x.value = JSON.stringify(result);
					x.value += result.length;
				},
			
				error: function(error) {
					var x = document.getElementById("txt");
					x.value = JSON.stringify(error);
				}
			});
		}


		function CreateRoomType() {
			Parse.Cloud.run('createRoomType', {}, {
					success: function(result) {
						var x = document.getElementById("txt");
						x.value = result;
					},
				
					error: function(error) {
						var x = document.getElementById("txt");
						x.value = JSON.stringify(error);
					}
				}
			);
		}

		
		function press(e){
			var unicode = e.keyCode ? e.keyCode : e.charCode;
			if(unicode == 13) {
				RunFunction();
			}
		}
		</script>
	</head>

	<body>
		RESULT:
		</br>
		<textarea id="txt" rows="4" cols="160"></textarea>
		</br>
		ANALYSIS:
		</br>
		<textarea id="txt2" rows="4" cols="160"></textarea>
		<p id="para">SENT: 0</p>
		
		FUNCTION:
		</br>
		<input id="message" type="text" onkeyup="press(event)">
		</br>
		<button type="button" onclick="RunFunction()">Run Function</button>
		</br>
		<button type="button" onclick="Get3Words()">Get3Words</button>
		</br>
		<button type="button" onclick="Gen100Matches()">Gen100Matches</button>
		</br>
		<button type="button" onclick="LogIn()">LogIn</button>
		</br>
		<button type="button" onclick="LogOut()">LogOut</button>
		</br>
		<button type="button" onclick="GetMatch()">GetMatch</button>
		</br>
		<button type="button" onclick="Submit()">Submit</button>
		</br>
		ROOM NAME:
		<input type="text" id="roomName" >
		<button type="button" onclick="GetResult()">GetResult</button>
		</br>
		<button type="button" onclick="GetRandomWords4_6()">GetRandomWords4_6</button>
		</br>
		<button type="button" onclick="ScheduleGetMatch()">ScheduleGetMatch</button>
		</br>
		<button type="button" onclick="StopScheduleGetMatch()">StopScheduleGetMatch</button>
		<button type="button" onclick="CreateRoomType()">CreateRoomType</button>
		</br>
	</body>
</html>

